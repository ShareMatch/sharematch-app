-- Migration: Update Prices and Add Eurovision
-- Date: 2025-12-13

DO $$
BEGIN

-- 1. Update Existing Assets (EPL, UCL, WC, SPL, F1, NBA, NFL, T20)
-- Using a temporary table (VALUES) for bulk update efficiency
UPDATE assets AS a
SET
    bid = v.bid,
    offer = v.offer,
    updated_at = NOW()
FROM (VALUES
    -- EPL (1-20)
    (1, 54.9, 60.7), (2, 31.7, 35.0), (3, 2.1, 2.3), (4, 1.9, 2.1), (5, 1.2, 1.3),
    (6, 0.1, 0.2), (7, 0.1, 0.2), (8, 0.1, 0.2), (9, 0.1, 0.2), (10, 0.1, 0.2),
    (11, 0.1, 0.2), (12, 2.6, 2.8), (13, 0.1, 0.2), (14, 0.1, 0.2), (15, 0.1, 0.2),
    (16, 0.1, 0.2), (17, 0.1, 0.2), (18, 0.1, 0.2), (19, 0.1, 0.2), (20, 0.1, 0.2),
    -- UCL (101-136)
    (101, 21.1, 23.3), (102, 17.3, 19.1), (103, 11.9, 13.1), (104, 8.6, 9.5), (105, 13.6, 15.0),
    (106, 9.5, 10.5), (107, 8.6, 9.5), (108, 5.0, 5.5), (109, 3.3, 3.6), (110, 1.9, 2.1),
    (111, 2.8, 3.1), (112, 1.9, 2.1), (113, 1.4, 1.6), (114, 1.9, 2.1), (115, 0.1, 0.2),
    (116, 1.2, 1.3), (117, 0.1, 0.2), (118, 0.1, 0.2), (119, 0.1, 0.2), (120, 0.1, 0.2),
    (121, 0.1, 0.2), (122, 0.1, 0.2), (123, 0.1, 0.2), (124, 0.1, 0.2), (125, 0.1, 0.2),
    (126, 0.1, 0.2), (127, 0.1, 0.2), (128, 0.1, 0.2), (129, 0.1, 0.2), (130, 0.1, 0.2),
    (131, 0.1, 0.2), (132, 0.1, 0.2), (133, 0.1, 0.2), (134, 0.1, 0.2), (135, 0.1, 0.2), (136, 0.1, 0.2),
    -- WC (201-260)
    (201, 17.3, 19.1), (202, 14.6, 16.2), (203, 10.6, 11.7), (204, 10.6, 11.7), (205, 10.6, 11.7),
    (206, 7.9, 8.8), (207, 7.3, 8.1), (208, 4.5, 5.0), (209, 3.7, 4.0), (210, 2.8, 3.1),
    (211, 2.8, 3.1), (212, 1.4, 1.6), (213, 1.9, 2.1), (214, 1.4, 1.6), (215, 1.2, 1.3),
    (216, 0.1, 0.2), (217, 0.1, 0.2), (218, 1.2, 1.3), (219, 1.2, 1.3), (220, 0.1, 0.2),
    (221, 0.1, 0.2), (222, 0.1, 0.2), (223, 0.1, 0.2), (224, 0.1, 0.2), (225, 0.1, 0.2),
    (226, 0.1, 0.2), (227, 0.1, 0.2), (228, 0.1, 0.2), (229, 0.1, 0.2), (230, 0.1, 0.2),
    (231, 0.1, 0.2), (232, 0.1, 0.2), (233, 0.1, 0.2), (234, 0.1, 0.2), (235, 0.1, 0.2),
    (236, 0.1, 0.2), (237, 0.1, 0.2), (238, 0.1, 0.2), (239, 0.1, 0.2), (240, 0.1, 0.2),
    (241, 0.1, 0.2), (242, 0.1, 0.2), (243, 0.1, 0.2), (244, 0.1, 0.2), (245, 0.1, 0.2),
    (246, 0.1, 0.2), (247, 0.1, 0.2), (248, 0.1, 0.2), (249, 0.1, 0.2), (250, 0.1, 0.2),
    (251, 0.1, 0.2), (252, 0.1, 0.2), (253, 0.1, 0.2), (254, 0.1, 0.2), (255, 0.1, 0.2),
    (256, 0.1, 0.2), (257, 0.1, 0.2), (258, 0.1, 0.2), (259, 0.1, 0.2), (260, 0.1, 0.2),
    -- SPL (301-318)
    (301, 43.2, 47.7), (302, 39.9, 44.1), (303, 6.3, 7.0), (304, 7.3, 8.1), (305, 9.5, 10.5),
    (306, 3.7, 4.0), (307, 0.1, 0.2), (308, 0.1, 0.2), (309, 0.1, 0.2), (310, 0.1, 0.2),
    (311, 0.1, 0.2), (312, 0.1, 0.2), (313, 0.1, 0.2), (314, 0.1, 0.2), (315, 0.1, 0.2),
    (316, 0.1, 0.2), (317, 0.1, 0.2), (318, 0.1, 0.2),
    -- F1 (401-403)
    (401, 70.4, 77.8), (402, 5.6, 6.2), (403, 20.7, 22.8),
    -- NBA (404-433)
    (404, 40.4, 44.7), (405, 13.6, 15.0), (406, 8.6, 9.5), (407, 7.3, 8.1), (408, 6.3, 7.0),
    (409, 7.3, 8.1), (410, 4.1, 4.6), (411, 3.7, 4.0), (412, 3.7, 4.0), (413, 3.7, 4.0),
    (414, 2.3, 2.6), (415, 1.9, 2.1), (416, 1.9, 2.1), (417, 2.3, 2.6), (418, 1.9, 2.1),
    (419, 1.2, 1.3), (420, 0.1, 0.2), (421, 0.1, 0.2), (422, 0.1, 0.2), (423, 0.1, 0.2),
    (424, 0.1, 0.2), (425, 0.1, 0.2), (426, 1.2, 1.3), (427, 0.1, 0.2), (428, 0.1, 0.2),
    (429, 0.1, 0.2), (430, 0.1, 0.2), (431, 0.1, 0.2), (432, 0.1, 0.2), (433, 0.1, 0.2),
    -- NFL (434-460)
    (434, 17.3, 19.1), (435, 9.5, 10.5), (436, 8.6, 9.5), (437, 10.6, 11.7), (438, 7.9, 8.8),
    (439, 9.5, 10.5), (440, 7.9, 8.8), (441, 5.6, 6.2), (442, 5.6, 6.2), (443, 4.5, 5.0),
    (444, 5.6, 6.2), (445, 3.7, 4.0), (446, 3.7, 4.0), (447, 3.3, 3.6), (448, 2.3, 2.6),
    (449, 2.6, 2.9), (450, 3.1, 3.4), (451, 0.1, 0.2), (452, 0.1, 0.2), (453, 0.1, 0.2),
    (454, 0.1, 0.2), (455, 0.1, 0.2), (456, 0.1, 0.2), (457, 0.1, 0.2), (458, 0.1, 0.2),
    (459, 0.1, 0.2), (460, 0.1, 0.2),
    -- T20 (461-480)
    (461, 39.9, 44.1), (462, 19.0, 21.0), (463, 14.6, 16.2), (464, 17.3, 19.1), (465, 5.6, 6.2),
    (466, 5.6, 6.2), (467, 4.5, 5.0), (468, 3.7, 4.0), (469, 2.3, 2.6), (470, 0.1, 0.2),
    (471, 0.1, 0.2), (472, 0.1, 0.2), (473, 0.1, 0.2), (474, 0.1, 0.2), (475, 0.1, 0.2),
    (476, 0.1, 0.2), (477, 0.1, 0.2), (478, 0.1, 0.2), (479, 0.1, 0.2), (480, 0.1, 0.2)
) AS v(id, bid, offer)
WHERE a.id = v.id;

-- 2. Insert Eurovision Assets (481-505)
INSERT INTO assets (id, name, market, bid, offer, category, last_change, color, updated_at) VALUES
(481, 'Israel', 'Eurovision', 14.8, 16.4, 'global_events', 'none', '#333333', NOW()),
(482, 'Finland', 'Eurovision', 15.8, 17.5, 'global_events', 'none', '#333333', NOW()),
(483, 'Sweden', 'Eurovision', 14.0, 15.4, 'global_events', 'none', '#333333', NOW()),
(484, 'Ukraine', 'Eurovision', 7.9, 8.8, 'global_events', 'none', '#333333', NOW()),
(485, 'Italy', 'Eurovision', 7.3, 8.1, 'global_events', 'none', '#333333', NOW()),
(486, 'Luxembourg', 'Eurovision', 7.0, 7.8, 'global_events', 'none', '#333333', NOW()),
(487, 'France', 'Eurovision', 4.5, 5.0, 'global_events', 'none', '#333333', NOW()),
(488, 'Norway', 'Eurovision', 4.8, 5.3, 'global_events', 'none', '#333333', NOW()),
(489, 'Belgium', 'Eurovision', 4.5, 5.0, 'global_events', 'none', '#333333', NOW()),
(490, 'Bulgaria', 'Eurovision', 4.1, 4.6, 'global_events', 'none', '#333333', NOW()),
(491, 'Denmark', 'Eurovision', 4.1, 4.6, 'global_events', 'none', '#333333', NOW()),
(492, 'Croatia', 'Eurovision', 4.0, 4.4, 'global_events', 'none', '#333333', NOW()),
(493, 'Cyprus', 'Eurovision', 4.0, 4.4, 'global_events', 'none', '#333333', NOW()),
(494, 'Lithuania', 'Eurovision', 4.0, 4.4, 'global_events', 'none', '#333333', NOW()),
(495, 'Netherlands', 'Eurovision', 0.1, 0.2, 'global_events', 'none', '#333333', NOW()),
(496, 'Moldova', 'Eurovision', 3.8, 4.2, 'global_events', 'none', '#333333', NOW()),
(497, 'United Kingdom', 'Eurovision', 3.7, 4.0, 'global_events', 'none', '#333333', NOW()),
(498, 'Romania', 'Eurovision', 3.5, 3.9, 'global_events', 'none', '#333333', NOW()),
(499, 'Estonia', 'Eurovision', 3.7, 4.0, 'global_events', 'none', '#333333', NOW()),
(500, 'Greece', 'Eurovision', 3.7, 4.0, 'global_events', 'none', '#333333', NOW()),
(501, 'Poland', 'Eurovision', 3.7, 4.0, 'global_events', 'none', '#333333', NOW()),
(502, 'Switzerland', 'Eurovision', 3.5, 3.9, 'global_events', 'none', '#333333', NOW()),
(503, 'Spain', 'Eurovision', 3.5, 3.9, 'global_events', 'none', '#333333', NOW()),
(504, 'Latvia', 'Eurovision', 3.5, 3.9, 'global_events', 'none', '#333333', NOW()),
(505, 'Montenegro', 'Eurovision', 3.5, 3.9, 'global_events', 'none', '#333333', NOW())
ON CONFLICT (id) DO UPDATE SET
    market = EXCLUDED.market,
    name = EXCLUDED.name,
    bid = EXCLUDED.bid,
    offer = EXCLUDED.offer,
    category = EXCLUDED.category,
    updated_at = NOW();

END $$;
