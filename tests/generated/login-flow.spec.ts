/**
 * Login Flow Tests
 * 
 * Auto-generated by CodeGenerator Agent
 * Generated at: 2026-01-07T10:55:29.704Z
 * Risk Level: HIGH
 * 
 * Scenarios:
 *   - Login with valid email and password (happy_path)
 *   - Login with invalid email and password (negative)
 *   - Login with empty email and password (negative)
 *   - Login with password visibility toggle (edge_case)
 *   - Login with forgot password (edge_case)
 *   - Login with SQL injection attempt (security)
 *   - Login with cross-site scripting attempt (security)
 *   - Login with brute force attempt (security)
 * 
 * DO NOT EDIT DIRECTLY - regenerate using the test planner
 */

import { test, expect } from '../../adapters';

const TEST_USER = {
  email: `affan@sharematch.me`,
  password: 'Affan@1234',
  fullName: 'Test User',
  phone: '501234567',
  dob: { month: '0', year: '1990', day: '15' },
};

test.describe('Login Flow', () => {
  // test.beforeEach(async ({ supabaseAdapter }) => {
  //   console.log(`[Setup] Cleaning up test user: ${TEST_USER.email}`);
  //   await supabaseAdapter.deleteTestUser(TEST_USER.email);
  // });

  // test.afterEach(async ({ supabaseAdapter }) => {
  //   await supabaseAdapter.deleteTestUser(TEST_USER.email);
  // });

  test('Login with valid email and password', async ({ page, supabaseAdapter }) => {
    console.log('[Test] Starting...');
    await page.goto('/?action=login');
    await page.locator('[data-testid="login-modal"]').waitFor({ timeout: 5000 });
    await page.locator('#login-email').fill(TEST_USER.email);
    await page.locator('#login-password').fill(TEST_USER.password);
    await page.locator('[data-testid="login-submit-button"]').click();
    await expect(page.locator('[data-testid="login-modal"]')).not.toBeVisible();
    console.log('[Test] Completed');
  });

  test('Login with invalid email and password', async ({ page, supabaseAdapter }) => {
    console.log('[Test] Starting...');
    await page.goto('/?action=login');
    await page.locator('[data-testid="login-modal"]').waitFor({ timeout: 5000 });
    await page.locator('#login-email').fill('invalid@example.com');
    await page.locator('#login-password').fill('InvalidPassword');
    await page.locator('[data-testid="login-submit-button"]').click();
    await expect(page.locator('.text-red-400')).toBeVisible();
    console.log('[Test] Completed');
  });

  test('Login with empty email and password', async ({ page, supabaseAdapter }) => {
    console.log('[Test] Starting...');
    await page.goto('/?action=login');
    await page.locator('[data-testid="login-modal"]').waitFor({ timeout: 5000 });
    await page.locator('[data-testid="login-submit-button"]').click();
    await expect(page.locator('.text-red-400')).toBeVisible();
    console.log('[Test] Completed');
  });

  test('Login with password visibility toggle', async ({ page, supabaseAdapter }) => {
    console.log('[Test] Starting...');
    await page.goto('/?action=login');
    await page.locator('[data-testid="login-modal"]').waitFor({ timeout: 5000 });
    await page.locator('#login-email').fill(TEST_USER.email);
    await page.locator('#login-password').fill(TEST_USER.password);
    await page.locator('[aria-label="Show password"]').click();
    await page.locator('[aria-label="Hide password"]').click();
    await expect(page.locator('#login-password')).toBeVisible();
    console.log('[Test] Completed');
  });

  test('Login with forgot password', async ({ page, supabaseAdapter }) => {
    console.log('[Test] Starting...');
    await page.goto('/?action=login');
    await page.locator('[data-testid="login-modal"]').waitFor({ timeout: 5000 });
    await page.locator('[data-testid="login-forgot-password"]').click();
    await expect(page.locator('button:has-text("Need help logging in?")')).toBeVisible();
    console.log('[Test] Completed');
  });

  test('Login with SQL injection attempt', async ({ page, supabaseAdapter }) => {
    console.log('[Test] Starting...');
    await page.goto('/?action=login');
    await page.locator('[data-testid="login-modal"]').waitFor({ timeout: 5000 });
    await page.locator('#login-email').fill(TEST_USER.email);
    await page.locator('#login-password').fill("TestPassword123!' OR 1=1");
    await page.locator('[data-testid="login-submit-button"]').click();
    await expect(page.locator('.text-red-400')).toBeVisible();
    console.log('[Test] Completed');
  });

  test('Login with cross-site scripting attempt', async ({ page, supabaseAdapter }) => {
    console.log('[Test] Starting...');
    await page.goto('/?action=login');
    await page.locator('[data-testid="login-modal"]').waitFor({ timeout: 5000 });
    await page.locator('#login-email').fill(TEST_USER.email);
    await page.locator('#login-password').fill('<script>alert("XSS")</script>');
    await page.locator('[data-testid="login-submit-button"]').click();
    await expect(page.locator('.text-red-400')).toBeVisible();
    console.log('[Test] Completed');
  });

  test('Login with brute force attempt', async ({ page, supabaseAdapter }) => {
    console.log('[Test] Starting...');
    await page.goto('/?action=login');
    await page.locator('[data-testid="login-modal"]').waitFor({ timeout: 5000 });
    await page.locator('#login-email').fill(TEST_USER.email);
    await page.locator('#login-password').fill(TEST_USER.password);
    await page.locator('[data-testid="login-submit-button"]').click();
    await page.locator('#login-password').fill('wrongpassword');
    await page.locator('[data-testid="login-submit-button"]').click();
    await expect(page.locator('.text-red-400')).toBeVisible();
    console.log('[Test] Completed');
  });
});