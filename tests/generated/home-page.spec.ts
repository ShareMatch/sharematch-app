/**
 * Home Page Tests
 * 
 * Auto-generated by CodeGenerator Agent
 * Generated at: 2026-01-06T13:00:00.000Z
 * Risk Level: MEDIUM
 * 
 * Tests for the home page functionality using ACTUAL selectors from the app.
 * 
 * DO NOT EDIT DIRECTLY - regenerate using the test planner
 */

import { test, expect } from '../../adapters';

test.describe('Home Page', () => {
  
  test.beforeEach(async ({ page }) => {
    // Navigate to home page
    await page.goto('/');
    // Wait for page to load
    await page.waitForLoadState('networkidle');
  });

  test('Home Page Load', async ({ page }) => {
    console.log('[Test] Home Page Load Starting...');
    
    // Verify page loaded - check for logo
    await expect(page.locator('img[alt="ShareMatch"]').first()).toBeVisible();
    console.log('[Test] Logo is visible');
    
    // Check for navigation buttons (Sports, Home, etc.)
    await expect(page.getByRole('button', { name: /sports/i })).toBeVisible();
    console.log('[Test] Navigation is visible');
    
    // Check for Log In and Join Now buttons (for non-authenticated users)
    await expect(page.getByRole('button', { name: /log in/i })).toBeVisible();
    await expect(page.getByRole('button', { name: /join now/i })).toBeVisible();
    console.log('[Test] Auth buttons are visible');
    
    await page.screenshot({ path: 'test-results/home-page-load.png' });
    console.log('[Test] Home Page Load Completed');
  });

  test('Search Functionality', async ({ page }) => {
    console.log('[Test] Search Functionality Starting...');
    
    // Find the search input by placeholder (actual selector from TopBar.tsx)
    const searchInput = page.getByPlaceholder('Find assets and indices...');
    await expect(searchInput).toBeVisible();
    console.log('[Test] Search input found');
    
    // Type in search input
    await searchInput.fill('Barcelona');
    console.log('[Test] Entered search query');
    
    // Wait for search results dropdown to appear
    await page.waitForTimeout(500);
    
    // Check if results appear (they appear as buttons in a dropdown)
    const searchResults = page.locator('.absolute.top-full button').first();
    await expect(searchResults).toBeVisible({ timeout: 5000 });
    console.log('[Test] Search results appeared');
    
    await page.screenshot({ path: 'test-results/search-functionality.png' });
    console.log('[Test] Search Functionality Completed');
  });

  test('Sports Navigation Dropdown', async ({ page }) => {
    console.log('[Test] Sports Navigation Starting...');
    
    // Click Sports button in navigation
    const sportsButton = page.getByRole('button', { name: /sports/i });
    await expect(sportsButton).toBeVisible();
    await sportsButton.click();
    console.log('[Test] Clicked Sports button');
    
    // Wait for dropdown to expand
    await page.waitForTimeout(300);
    
    // Check for Football option
    const footballOption = page.getByRole('button', { name: /football/i });
    await expect(footballOption).toBeVisible();
    console.log('[Test] Football option visible');
    
    // Check for other sports
    await expect(page.getByRole('button', { name: /basketball/i })).toBeVisible();
    await expect(page.getByRole('button', { name: /motorsport/i })).toBeVisible();
    console.log('[Test] Other sports visible');
    
    await page.screenshot({ path: 'test-results/sports-navigation.png' });
    console.log('[Test] Sports Navigation Completed');
  });

  test('Football Leagues Dropdown', async ({ page }) => {
    console.log('[Test] Football Leagues Starting...');
    
    // Open Sports dropdown first
    await page.getByRole('button', { name: /sports/i }).click();
    await page.waitForTimeout(300);
    
    // Click Football to expand leagues
    await page.getByRole('button', { name: /football/i }).click();
    await page.waitForTimeout(300);
    
    // Check for leagues
    await expect(page.getByRole('button', { name: /england premier league/i })).toBeVisible();
    await expect(page.getByRole('button', { name: /uefa champions league/i })).toBeVisible();
    await expect(page.getByRole('button', { name: /saudi pro league/i })).toBeVisible();
    console.log('[Test] Football leagues are visible');
    
    await page.screenshot({ path: 'test-results/football-leagues.png' });
    console.log('[Test] Football Leagues Completed');
  });

  test('Buy Button Interaction', async ({ page }) => {
    console.log('[Test] Buy Button Starting...');
    
    // Find a Buy button on the page
    const buyButton = page.getByRole('button', { name: /buy/i }).first();
    
    if (await buyButton.isVisible()) {
      // Click the buy button
      await buyButton.click();
      console.log('[Test] Clicked Buy button');
      
      // This should trigger login modal for non-authenticated users
      // or open a trading modal for authenticated users
      await page.waitForTimeout(1000);
      
      // Check if login modal appeared (for non-auth users)
      const loginModal = page.locator('[data-testid="login-modal"]');
      const isLoginModalVisible = await loginModal.isVisible().catch(() => false);
      
      if (isLoginModalVisible) {
        console.log('[Test] Login modal appeared (expected for non-auth users)');
        // Close modal
        await page.keyboard.press('Escape');
      }
    } else {
      console.log('[Test] No Buy button visible');
    }
    
    await page.screenshot({ path: 'test-results/buy-button.png' });
    console.log('[Test] Buy Button Completed');
  });

  test('View More Button', async ({ page }) => {
    console.log('[Test] View More Button Starting...');
    
    // Find View More button
    const viewMoreButton = page.getByRole('button', { name: /view more/i });
    
    if (await viewMoreButton.isVisible()) {
      await viewMoreButton.click();
      console.log('[Test] Clicked View More button');
      await page.waitForTimeout(500);
    } else {
      console.log('[Test] No View More button visible');
    }
    
    await page.screenshot({ path: 'test-results/view-more.png' });
    console.log('[Test] View More Button Completed');
  });
});
